"""
分析 SVG 路径数据，为每个省份生成精确的闭合多边形路径
基于种子点和边界交点
"""

# 原始 SVG 路径中的关键节点坐标
# 从 SVG 路径中提取的所有节点
nodes = {
    # 外轮廓节点
    'A': (30, 14),
    'B': (28.09, 16.716),
    'C': (30, 21),
    'D': (27, 28),
    'E': (20, 32),
    'F': (14, 31),
    'G': (9, 33),
    'H': (6, 29),
    'I': (7, 27),
    'J': (6, 25),
    'K': (-2, 24),
    'L': (-9, 19),
    'M': (-9, 14),
    'N': (-11, 12),
    'O': (-10, 7),
    'P': (-8, 7),
    'Q': (0, 0),
    'R': (3, 0),
    'S': (8, 8),
    'T': (15, 10),
    'U': (24, 5),
    'V': (22, 4),
    'W': (25, -2),
    'X': (28, -3),
    'Y': (33, 1),
    'Z': (35, 1),
    'AA': (36, 4),
    'AB': (35, 5),
    'AC': (35, 7),
    'AD': (31, 11),
    'AE': (29, 10),
    'AF': (26, 12),
    'AG': (27, 14),
    'AH': (28, 13),
    
    # 内部节点
    'a': (1, 14),
    'b': (0, 16),
    'c': (2, 19),
    'd': (6, 20),
    'e': (7, 19),
    'f': (8, 24),
    'g': (10, 20),
    'h': (11, 18),
    'i': (12, 15),
    'j': (8, 13),
    'k': (6, 14),
    'l': (3.739, 11.663),
    'm': (9, 11),
    'n': (11, 12),
    'o': (12, 13),
    'p': (14, 13),
    'q': (15, 16),
    'r': (16, 13),
    's': (17, 16),
    't': (17, 18),
    'u': (16, 19),
    'v': (16, 20),
    'w': (14, 20),
    'x': (17, 22),
    'y': (16, 24),
    'z': (14, 24),
    
    '1': (14, 26),
    '2': (15, 27),
    '3': (11, 29),
    '4': (28, -1),
    '5': (29, 4),
    '6': (35, 6),
    '7': (28, 6),
    '8': (30, 7),
    '9': (29, 8),
    '10': (33, 9),
    '11': (27, 10),
    '12': (27.549, 10.943),
    '13': (25, 9),
    '14': (22, 12),
    '15': (22, 16),
    '16': (19, 14),
    '17': (23, 20),
    '18': (25, 19),
    '19': (24, 18),
    '20': (26, 11),
    '21': (25, 11),
    '22': (25, 12),
    '23': (24, 16),
    '24': (23, 22),
    '25': (27, 21),
    '26': (26, 24),
    '27': (27.874, 25.923),
    '28': (24, 24),
    '29': (19, 21),
    '30': (19, 23),
    '31': (18, 24),
    '32': (17, 25),
    '33': (19, 25),
    '34': (27, 25),
    '35': (23, 28),
    '36': (24.569, 29.413),
    '37': (21, 28),
    '38': (18.038, 31.7),
    '39': (22.011, 24.511),
    '40': (19, 28),
    '41': (13.581, 29.84),
    '42': (21, 22),
    '43': (19, 22),
    '44': (19, 18),
    '45': (24, 12),
    '46': (25, 13),
    '47': (24, 13),
    '48': (29.498, 20.017),
    '49': (29, 21),
    
    # 岛屿
    'TW1': (30, 28),
    'TW2': (29, 31),
    'TW3': (30, 32),
    'TW4': (31, 29),
    'HN1': (19, 34),
    'HN2': (17, 35),
    'HN3': (18, 36),
    'HN4': (20, 35),
    'HK1': (23, 31),
    'HK2': (24, 31),
    'HK3': (24, 32),
    'HK4': (23, 32),
    'MO1': (21, 32),
    'MO2': (22, 32),
    'MO3': (22, 33),
    'MO4': (21, 33),
}

# 根据地理位置和边界线，定义每个省份的顶点（按顺时针或逆时针顺序）
# 使用种子点作为参考确定每个省份的位置
seeds = {
    '新疆': (-4.5, 7.5),
    '西藏': (-2.5, 18.5),
    '青海': (6.0, 13.5),
    '甘肃': (10.0, 12.5),
    '宁夏': (19.5, 15.0),
    '内蒙古': (18.0, 9.0),
    '黑龙江': (31.5, 5.5),
    '吉林': (29.5, 9.5),
    '辽宁': (27.0, 13.0),
    '河北': (24.0, 17.0),
    '北京': (24.5, 16.6),
    '天津': (25.0, 17.4),
    '山西': (20.0, 16.0),
    '陕西': (15.0, 20.0),
    '山东': (27.5, 20.5),
    '河南': (21.0, 21.0),
    '江苏': (26.5, 24.5),
    '安徽': (23.0, 24.0),
    '上海': (27, 24),
    '浙江': (25.5, 27.5),
    '福建': (24.0, 30.0),
    '江西': (21.0, 27.0),
    '湖北': (18.5, 23.5),
    '湖南': (17.0, 27.0),
    '广东': (22.0, 30.5),
    '广西': (12.5, 29.5),
    '海南': (19.0, 35.0),
    '四川': (11.0, 21.0),
    '重庆': (17.0, 23.0),
    '贵州': (15.0, 27.0),
    '云南': (5.0, 26.0),
    '台湾': (30.2, 29.5),
    '香港': (23.5, 31.5),
    '澳门': (21.5, 32.5),
}

# 根据分析的边界，为每个省份定义精确的顶点坐标
# 略微缩小以避免重叠
def shrink_polygon(points, factor=0.92):
    """将多边形向中心收缩"""
    if len(points) < 3:
        return points
    
    # 计算中心点
    cx = sum(p[0] for p in points) / len(points)
    cy = sum(p[1] for p in points) / len(points)
    
    # 将每个点向中心移动
    result = []
    for x, y in points:
        nx = cx + (x - cx) * factor
        ny = cy + (y - cy) * factor
        result.append((nx, ny))
    
    return result

def points_to_path(points):
    """将点列表转换为 SVG path d 属性"""
    if not points:
        return ""
    path = f"M {points[0][0]} {points[0][1]}"
    for x, y in points[1:]:
        path += f" L {x} {y}"
    path += " Z"
    return path

# 定义每个省份的边界顶点（基于 SVG 路径分析）
provinces = {
    # 新疆: 西北角大区域
    '新疆': [(0, 0), (3, 0), (8, 8), (3.739, 11.663), (6, 14), (8, 13), (12, 15), (11, 18), (10, 20), (7, 19), (6, 20), (2, 19), (0, 16), (1, 14), (-9, 14), (-11, 12), (-10, 7), (-8, 7)],
    
    # 西藏: 西南区域
    '西藏': [(-9, 14), (1, 14), (0, 16), (2, 19), (6, 20), (6, 25), (-2, 24), (-9, 19)],
    
    # 青海: 新疆东南，西藏东北
    '青海': [(8, 13), (9, 11), (11, 12), (12, 13), (14, 13), (16, 13), (17, 16), (15, 16), (12, 15), (11, 18), (10, 20), (7, 19), (6, 20), (8, 24), (6, 25), (6, 20)],
    
    # 甘肃: 狭长区域
    '甘肃': [(8, 8), (9, 11), (11, 12), (12, 13), (14, 13), (17, 16), (19, 14), (22, 12), (25, 9), (27, 10), (29, 8), (30, 7), (28, 6), (29, 4), (28, -1), (25, -2), (22, 4), (24, 5), (15, 10)],
    
    # 宁夏: 小区域
    '宁夏': [(19, 14), (22, 12), (22, 16), (19, 18)],
    
    # 内蒙古: 北部狭长区域
    '内蒙古': [(3, 0), (8, 8), (15, 10), (24, 5), (22, 4), (25, -2), (28, -1), (29, 4), (35, 6), (35, 7), (31, 11), (29, 10), (27, 10), (25, 9), (22, 12), (19, 14), (17, 16), (16, 13), (14, 13), (12, 13), (11, 12), (9, 11), (8, 8), (3.739, 11.663), (6, 14), (8, 13)],
    
    # 黑龙江: 东北角
    '黑龙江': [(29, 4), (28, -1), (25, -2), (28, -3), (33, 1), (35, 1), (36, 4), (35, 5), (35, 6)],
    
    # 吉林: 黑龙江南
    '吉林': [(29, 4), (35, 6), (35, 7), (31, 11), (33, 9), (29, 8), (27, 10), (25, 9), (26, 11), (26, 12)],
    
    # 辽宁: 吉林南，渤海边
    '辽宁': [(26, 12), (29, 10), (31, 11), (29, 10), (27.549, 10.943), (27, 10), (29, 8), (30, 7), (28, 6), (28.09, 16.716), (28.028, 16.692), (27, 14), (28, 13), (30, 14)],
    
    # 河北: 北京天津周围
    '河北': [(22, 12), (26, 12), (28.028, 16.692), (27, 21), (25, 19), (24, 18), (24, 16), (22, 16)],
    
    # 北京: 小区域
    '北京': [(24, 12), (25, 12), (25, 13), (24, 13)],
    
    # 天津: 小区域
    '天津': [(25, 11), (26, 11), (26, 12), (25, 12)],
    
    # 山西: 河北西
    '山西': [(17, 16), (19, 14), (19, 18), (22, 16), (22, 12), (19, 14), (17, 16), (16, 19), (16, 20), (17, 22), (19, 22), (19, 14)],
    
    # 陕西: 山西西南
    '陕西': [(14, 13), (16, 13), (17, 16), (16, 19), (16, 20), (17, 22), (16, 24), (14, 24), (14, 26), (17, 25), (19, 25), (18, 24), (19, 23), (19, 21), (19, 22), (17, 22)],
    
    # 山东: 渤海边半岛
    '山东': [(24, 16), (26, 12), (28.028, 16.692), (27, 21), (25, 19), (23, 20), (24, 18)],
    
    # 河南: 中原
    '河南': [(19, 18), (22, 16), (24, 16), (24, 18), (23, 20), (23, 22), (21, 22), (19, 21), (19, 22), (17, 22), (16, 20), (16, 19), (17, 18), (17, 16), (19, 14)],
    
    # 江苏: 东部沿海
    '江苏': [(23, 20), (25, 19), (27, 21), (26, 24), (24, 24), (23, 22)],
    
    # 上海: 小区域  
    '上海': [(26, 24), (27, 21), (27.874, 25.923)],
    
    # 安徽: 江苏西
    '安徽': [(21, 22), (23, 22), (24, 24), (22.011, 24.511), (19, 25), (18, 24), (19, 23), (19, 21)],
    
    # 浙江: 东南沿海
    '浙江': [(24, 24), (26, 24), (27.874, 25.923), (27, 25), (23, 28), (21, 28), (22.011, 24.511)],
    
    # 福建: 浙江南
    '福建': [(23, 28), (27, 25), (27.874, 25.923), (27, 28), (20, 32), (18.038, 31.7), (21, 28)],
    
    # 江西: 福建西
    '江西': [(19, 25), (22.011, 24.511), (21, 28), (18.038, 31.7), (13.581, 29.84), (19, 28)],
    
    # 湖北: 中部
    '湖北': [(17, 22), (19, 22), (19, 21), (21, 22), (19, 25), (18, 24), (19, 23), (19, 25), (17, 25), (14, 26), (16, 24)],
    
    # 湖南: 湖北南
    '湖南': [(14, 26), (17, 25), (19, 25), (19, 28), (13.581, 29.84), (11, 29), (15, 27)],
    
    # 广东: 南部沿海
    '广东': [(18.038, 31.7), (20, 32), (27, 28), (27.874, 25.923), (26, 24), (27, 21), (30, 21), (29, 21), (27, 28), (23, 28), (21, 28)],
    
    # 广西: 广东西
    '广西': [(9, 33), (6, 29), (7, 27), (6, 25), (8, 24), (11, 29), (13.581, 29.84), (19, 28), (18.038, 31.7), (14, 31)],
    
    # 海南: 岛屿
    '海南': [(19, 34), (17, 35), (18, 36), (20, 35)],
    
    # 四川: 西南大省
    '四川': [(12, 15), (11, 18), (14, 20), (16, 20), (17, 22), (16, 24), (14, 24), (14, 26), (15, 27), (11, 29), (8, 24), (6, 20), (7, 19), (10, 20), (11, 18)],
    
    # 重庆: 四川东
    '重庆': [(16, 20), (17, 22), (16, 24), (14, 26), (14, 24), (16, 24), (17, 22), (19, 22), (19, 21), (19, 23), (18, 24), (17, 25)],
    
    # 贵州: 四川南
    '贵州': [(14, 26), (15, 27), (11, 29), (13.581, 29.84), (19, 28), (19, 25), (17, 25)],
    
    # 云南: 西南
    '云南': [(6, 25), (8, 24), (11, 29), (15, 27), (14, 26), (6, 25), (-2, 24), (-9, 19), (-9, 14), (1, 14), (0, 16), (2, 19), (6, 20)],
    
    # 台湾: 岛屿
    '台湾': [(30, 28), (29, 31), (30, 32), (31, 29)],
    
    # 香港: 小区域
    '香港': [(23, 31), (24, 31), (24, 32), (23, 32)],
    
    # 澳门: 小区域
    '澳门': [(21, 32), (22, 32), (22, 33), (21, 33)],
}

# 重新精确定义每个省份（基于更仔细的分析）
provinces_refined = {
    # 新疆: 西北大区
    '新疆': [(0, 0), (3, 0), (8, 8), (1, 14), (0, 16), (2, 19), (6, 20), (7, 19), (10, 20), (11, 18), (12, 15), (8, 13), (6, 14), (3.739, 11.663), (-9, 14), (-11, 12), (-10, 7), (-8, 7)],
    
    # 西藏
    '西藏': [(-9, 14), (1, 14), (0, 16), (2, 19), (6, 20), (6, 25), (-2, 24), (-9, 19)],
    
    # 青海
    '青海': [(6, 14), (8, 13), (12, 15), (11, 18), (14, 20), (16, 20), (16, 19), (17, 18), (17, 16), (15, 16), (14, 13), (12, 13), (11, 12), (9, 11), (8, 8), (1, 14), (0, 16), (2, 19), (6, 20), (7, 19), (10, 20), (11, 18), (12, 15)],
    
    # 甘肃 - 复杂形状
    '甘肃': [(8, 8), (15, 10), (24, 5), (22, 4), (25, -2), (28, -1), (29, 4), (28, 6), (30, 7), (29, 8), (27, 10), (25, 9), (22, 12), (19, 14), (17, 16), (16, 13), (14, 13), (12, 13), (11, 12), (9, 11)],
    
    # 宁夏 - 小
    '宁夏': [(19, 14), (22, 12), (22, 16), (19, 18)],
    
    # 内蒙古 - 北部狭长
    '内蒙古': [(8, 8), (3, 0), (0, 0), (-8, 7), (-10, 7), (-11, 12), (-9, 14), (3.739, 11.663), (6, 14), (8, 13), (9, 11), (8, 8)],
    
    # 黑龙江
    '黑龙江': [(25, -2), (28, -3), (33, 1), (35, 1), (36, 4), (35, 5), (35, 6), (29, 4), (28, -1)],
    
    # 吉林
    '吉林': [(29, 4), (35, 6), (35, 7), (31, 11), (33, 9), (29, 8), (30, 7), (28, 6)],
    
    # 辽宁
    '辽宁': [(28, 6), (30, 7), (29, 8), (27, 10), (27.549, 10.943), (29, 10), (31, 11), (29, 10), (26, 12), (27, 14), (28, 13), (30, 14), (28.09, 16.716), (28.028, 16.692)],
    
    # 河北
    '河北': [(22, 12), (25, 9), (27, 10), (26, 12), (28.028, 16.692), (27, 21), (25, 19), (24, 18), (24, 16), (22, 16)],
    
    # 北京
    '北京': [(24, 12), (25, 12), (25, 13), (24, 13)],
    
    # 天津
    '天津': [(25, 11), (26, 11), (26, 12), (25, 12)],
    
    # 山西
    '山西': [(19, 14), (22, 12), (22, 16), (19, 18), (17, 16), (16, 13), (17, 16), (17, 18), (16, 19), (16, 20), (17, 22), (19, 22), (19, 14)],
    
    # 陕西
    '陕西': [(14, 13), (16, 13), (17, 16), (19, 14), (19, 22), (17, 22), (16, 20), (14, 20), (11, 18), (12, 15), (14, 13)],
    
    # 山东
    '山东': [(24, 16), (26, 12), (28.028, 16.692), (29.498, 20.017), (29, 21), (27, 21), (25, 19), (24, 18)],
    
    # 河南
    '河南': [(19, 18), (22, 16), (24, 16), (24, 18), (25, 19), (23, 20), (23, 22), (21, 22), (19, 21), (19, 22), (17, 22)],
    
    # 江苏
    '江苏': [(23, 20), (25, 19), (27, 21), (26, 24), (24, 24), (23, 22)],
    
    # 上海
    '上海': [(26, 24), (27, 21), (27.874, 25.923)],
    
    # 安徽
    '安徽': [(19, 21), (21, 22), (23, 22), (24, 24), (22.011, 24.511), (19, 25), (18, 24), (19, 23)],
    
    # 浙江
    '浙江': [(24, 24), (26, 24), (27.874, 25.923), (27, 25), (23, 28), (21, 28), (22.011, 24.511)],
    
    # 福建
    '福建': [(21, 28), (23, 28), (27, 25), (27.874, 25.923), (27, 28), (20, 32), (18.038, 31.7)],
    
    # 江西
    '江西': [(19, 25), (22.011, 24.511), (21, 28), (18.038, 31.7), (13.581, 29.84), (19, 28)],
    
    # 湖北
    '湖北': [(17, 22), (19, 22), (19, 21), (21, 22), (22.011, 24.511), (19, 25), (17, 25), (14, 26), (16, 24)],
    
    # 湖南
    '湖南': [(14, 26), (17, 25), (19, 25), (19, 28), (13.581, 29.84), (11, 29), (15, 27)],
    
    # 广东
    '广东': [(18.038, 31.7), (20, 32), (27, 28), (27.874, 25.923), (27, 25), (23, 28), (21, 28)],
    
    # 广西
    '广西': [(6, 25), (8, 24), (11, 29), (13.581, 29.84), (19, 28), (18.038, 31.7), (14, 31), (9, 33), (6, 29), (7, 27)],
    
    # 海南
    '海南': [(19, 34), (17, 35), (18, 36), (20, 35)],
    
    # 四川
    '四川': [(6, 20), (7, 19), (10, 20), (11, 18), (14, 20), (16, 20), (17, 22), (16, 24), (14, 24), (14, 26), (15, 27), (11, 29), (8, 24)],
    
    # 重庆
    '重庆': [(17, 22), (19, 22), (19, 21), (19, 23), (18, 24), (17, 25), (14, 26), (16, 24)],
    
    # 贵州
    '贵州': [(14, 26), (17, 25), (19, 25), (19, 28), (13.581, 29.84), (11, 29), (15, 27)],
    
    # 云南
    '云南': [(6, 20), (8, 24), (6, 25), (-2, 24), (-9, 19), (-9, 14), (1, 14), (0, 16), (2, 19)],
    
    # 台湾
    '台湾': [(30, 28), (29, 31), (30, 32), (31, 29)],
    
    # 香港
    '香港': [(23, 31), (24, 31), (24, 32), (23, 32)],
    
    # 澳门
    '澳门': [(21, 32), (22, 32), (22, 33), (21, 33)],
}

# 生成 SVG 路径
print("<!-- 省份点击层（透明） -->")
print('<g id="clickLayer" fill="transparent" stroke="none" cursor="pointer">')

for name, points in provinces_refined.items():
    # 缩小多边形以避免重叠
    shrunk = shrink_polygon(points, 0.90)
    path_d = points_to_path(shrunk)
    print(f'    <path id="area-{name}" d="{path_d}"/>')

print('</g>')
