"""
分析 SVG 坐标系与真实经纬度的映射关系
"""

# SVG viewBox: -11.1, -3.1, 47.2, 39.2
# 即 x 范围: -11.1 到 36.1
# 即 y 范围: -3.1 到 36.1

# 中国实际经纬度范围（大致）:
# 经度: 73.5 (新疆最西) 到 135.1 (黑龙江最东)
# 纬度: 3.8 (南海) 到 53.6 (黑龙江最北)

# 从 GeoJSON 数据:
# 新疆: center [84.94, 41.76]
# 黑龙江: center [128.14, 48.49]
# 海南: center [113.22, 11.99] (包含南海岛屿)
# 广东: center [113.42, 22.86]

# 从 main.js 的 seeds:
# 新疆: [-4.5, 7.5]
# 黑龙江: [31.5, 3.0]
# 海南: [18.5, 35.0]
# 广东: [23.0, 30.0] - 这个明显有问题，应该靠近广西

# 让我重新计算正确的 SVG 坐标
# 假设线性映射:
# SVG_X = (lon - LON_MIN) / (LON_MAX - LON_MIN) * SVG_WIDTH + SVG_MIN_X
# SVG_Y = (LAT_MAX - lat) / (LAT_MAX - LAT_MIN) * SVG_HEIGHT + SVG_MIN_Y  # 注意Y轴反转

# 从已知对应点推算:
# 新疆 center (84.94, 41.76) -> SVG (-4.5, 7.5)
# 黑龙江 center (128.14, 48.49) -> SVG (31.5, 3.0)

# 解方程:
# -4.5 = (84.94 - LON_MIN) / (LON_MAX - LON_MIN) * 47.2 + (-11.1)
# 31.5 = (128.14 - LON_MIN) / (LON_MAX - LON_MIN) * 47.2 + (-11.1)

# 6.6 = (84.94 - LON_MIN) / (LON_MAX - LON_MIN) * 47.2
# 42.6 = (128.14 - LON_MIN) / (LON_MAX - LON_MIN) * 47.2

# (84.94 - LON_MIN) / (128.14 - LON_MIN) = 6.6 / 42.6 = 0.155

# 设 LON_MIN = x
# (84.94 - x) / (128.14 - x) = 0.155
# 84.94 - x = 0.155 * (128.14 - x)
# 84.94 - x = 19.86 - 0.155x
# 65.08 = 0.845x
# x = 77.0

# 检验:
# (84.94 - 77) / (LON_MAX - 77) * 47.2 = 6.6
# 7.94 / (LON_MAX - 77) = 6.6 / 47.2 = 0.1398
# LON_MAX - 77 = 7.94 / 0.1398 = 56.8
# LON_MAX = 133.8

LON_MIN = 77.0
LON_MAX = 133.8
LAT_MIN = 17.0  # 估计值，不含南海
LAT_MAX = 54.0

SVG_MIN_X = -11.1
SVG_MIN_Y = -3.1
SVG_WIDTH = 47.2
SVG_HEIGHT = 39.2

def lon_to_svg_x(lon):
    return (lon - LON_MIN) / (LON_MAX - LON_MIN) * SVG_WIDTH + SVG_MIN_X

def lat_to_svg_y(lat):
    # Y 轴反转：纬度越大，SVG Y 越小
    return (LAT_MAX - lat) / (LAT_MAX - LAT_MIN) * SVG_HEIGHT + SVG_MIN_Y

# 真实地理中心点（经纬度）
real_centers = {
    '上海': [121.49, 31.27],
    '云南': [101.86, 25.18],
    '内蒙古': [111.62, 45.37],
    '北京': [116.47, 40.25],
    '台湾': [122.00, 23.91],
    '吉林': [126.48, 43.59],
    '四川': [102.95, 30.18],
    '天津': [117.39, 39.40],
    '宁夏': [105.97, 37.31],
    '安徽': [117.27, 32.02],
    '山东': [118.77, 36.38],
    '山西': [112.40, 37.66],
    '广东': [113.42, 22.86],
    '广西': [108.27, 23.70],
    '新疆': [84.94, 41.76],
    '江苏': [119.17, 32.94],
    '江西': [116.03, 27.28],
    '河北': [116.67, 39.34],
    '河南': [113.50, 33.87],
    '浙江': [120.43, 29.16],
    '海南': [110.00, 19.50],  # 修正：只取海南本岛
    '湖北': [112.25, 31.15],
    '湖南': [111.52, 27.38],
    '澳门': [113.57, 22.16],
    '甘肃': [100.53, 37.69],
    '福建': [118.16, 25.93],
    '西藏': [88.75, 31.67],
    '贵州': [106.60, 26.92],
    '辽宁': [122.32, 41.11],
    '重庆': [107.75, 30.18],
    '陕西': [108.37, 35.65],
    '青海': [96.24, 35.40],
    '香港': [114.12, 22.37],
    '黑龙江': [128.14, 48.49],
}

print("// 修正后的种子点 (SVG 坐标)")
print("const seeds = {")
for name, (lon, lat) in sorted(real_centers.items(), key=lambda x: x[0]):
    svg_x = lon_to_svg_x(lon)
    svg_y = lat_to_svg_y(lat)
    print(f"    '{name}': [{svg_x:.1f}, {svg_y:.1f}],")
print("};")

print("\n// 验证几个关键点:")
print(f"新疆: {lon_to_svg_x(84.94):.1f}, {lat_to_svg_y(41.76):.1f} (预期: -4.5, 7.5 左右)")
print(f"黑龙江: {lon_to_svg_x(128.14):.1f}, {lat_to_svg_y(48.49):.1f} (预期: 31.5, 3.0 左右)")
print(f"广东: {lon_to_svg_x(113.42):.1f}, {lat_to_svg_y(22.86):.1f}")
print(f"广西: {lon_to_svg_x(108.27):.1f}, {lat_to_svg_y(23.70):.1f}")
